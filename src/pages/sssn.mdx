/* è¿™æ˜¯ä¸€ä¸ªä¸“ä¸ºDocusaurusè®¾è®¡çš„ç¢ç¢å¿µï¼ˆæœ‹å‹åœˆé£æ ¼ï¼‰é¡µé¢ã€‚
   æ–‡ä»¶ä½ç½®ï¼šå»ºè®®æ”¾åœ¨ /src/pages/thoughts.mdx æˆ– /blog/thoughts.md
   ç¡®ä¿å®‰è£…äº† @docusaurus/theme-classic å’Œ MDX æ”¯æŒã€‚
   æ­¤é¡µé¢æ¨¡ä»¿å¾®ä¿¡æœ‹å‹åœˆæ ·å¼ï¼Œæ”¯æŒæš—è‰²æ¨¡å¼ã€‚
*/

import Layout from '@theme/Layout';
import Link from '@docusaurus/Link';
import useDocusaurusContext from '@docusaurus/useDocusaurusContext';
import { useEffect, useState } from 'react';

export const MdxComponents = {
    /* å¯ä»¥è¦†ç›–MDXç»„ä»¶ï¼Œè¿™é‡Œä¸éœ€è¦é¢å¤–å®šä¹‰ */
};

# ğŸ’­ æˆ‘çš„ç¢ç¢å¿µ Â· æœ‹å‹åœˆç‰ˆ

<div className="moment-container">

{/* è™šæ‹Ÿæ•°æ®ï¼šåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä½ å¯ä»¥å°†è¿™äº›å†…å®¹æ›¿æ¢ä¸ºä»æ–‡ä»¶æˆ–CMSè¯»å–çš„æ•°æ® */}
<MomentList />

</div>

{/* æ ·å¼å®šä¹‰ â€”â€” æ¨¡ä»¿æœ‹å‹åœˆå¡ç‰‡ï¼Œå…¼é¡¾Docusaurusæš—è‰²æ¨¡å¼ */}
<style>{`
    .moment-container {
        max-width: 600px;
        margin: 0 auto;
        padding: 1rem 0.5rem 3rem 0.5rem;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
    }
    /* æ—¶é—´è½´è£…é¥° */
    .moment-feed {
        position: relative;
    }
    .moment-feed::before {
        content: '';
        position: absolute;
        left: 30px;
        top: 10px;
        bottom: 10px;
        width: 2px;
        background: var(--ifm-color-emphasis-300);
        opacity: 0.3;
        border-radius: 2px;
    }
    /* æ¯æ¡æœ‹å‹åœˆå¡ç‰‡ */
    .moment-item {
        position: relative;
        margin-bottom: 1.5rem;
        padding-left: 60px; /* ç•™ç»™å¤´åƒå’Œæ—¶é—´è½´çš„ç©ºé—´ */
    }
    /* å¤´åƒéƒ¨åˆ† */
    .moment-avatar {
        position: absolute;
        left: 10px;
        top: 0;
        width: 40px;
        height: 40px;
        border-radius: 6px; /* å¾®ä¿¡é£æ ¼ç•¥æ–¹ */
        background-color: var(--ifm-color-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 18px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        z-index: 2;
        overflow: hidden;
    }
    .moment-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    /* åå­—å’Œå‘å¸ƒæ—¶é—´ */
    .moment-header {
        display: flex;
        align-items: baseline;
        flex-wrap: wrap;
        margin-bottom: 0.25rem;
    }
    .moment-author {
        font-weight: 600;
        font-size: 0.95rem;
        color: var(--ifm-color-primary);
        margin-right: 0.75rem;
    }
    .moment-time {
        font-size: 0.7rem;
        color: var(--ifm-color-emphasis-600);
    }
    /* å†…å®¹å¡ç‰‡ */
    .moment-content {
        background-color: var(--ifm-card-background-color);
        border-radius: 14px 18px 18px 18px; /* å·¦ä¸‹è§’æ›´åœ†ï¼Œæ¨¡ä»¿æ°”æ³¡ */
        padding: 0.9rem 1rem 0.7rem 1rem;
        box-shadow: 0 1px 2px rgba(0,0,0,0.02);
        border: 1px solid var(--ifm-color-emphasis-200);
        transition: background-color 0.2s;
        word-break: break-word;
    }
    /* çº¯æ–‡æœ¬å†…å®¹ */
    .moment-text {
        font-size: 0.95rem;
        line-height: 1.5;
        margin-bottom: 0.5rem;
        white-space: pre-wrap;
    }
    /* å›¾ç‰‡ä¹å®«æ ¼åŒºåŸŸ */
    .moment-images {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 4px;
        margin: 0.75rem 0 0.5rem 0;
        border-radius: 8px;
        overflow: hidden;
        max-width: 100%;
    }
    .moment-image-item {
        aspect-ratio: 1 / 1;
        background-color: var(--ifm-color-emphasis-200);
        background-size: cover;
        background-position: center;
        cursor: pointer;
        border-radius: 4px;
        transition: transform 0.1s ease;
    }
    .moment-image-item:hover {
        transform: scale(1.02);
    }
    /* å•å¼ å›¾ç‰‡ç‰¹æ®Šå¤„ç† */
    .moment-images.single {
        grid-template-columns: 1fr;
        max-width: 240px; /* å•å¼ å›¾é™åˆ¶å¤§å° */
    }
    .moment-images.single .moment-image-item {
        aspect-ratio: auto;
        max-height: 240px;
        width: auto;
        background-size: contain;
        background-repeat: no-repeat;
        background-color: transparent;
    }
    /* æ“ä½œæ  (ç‚¹èµ/è¯„è®º) */
    .moment-actions {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        margin-top: 0.4rem;
        font-size: 0.75rem;
        color: var(--ifm-color-emphasis-600);
        border-top: 1px dashed var(--ifm-color-emphasis-200);
        padding-top: 0.4rem;
    }
    .moment-like {
        display: flex;
        align-items: center;
        gap: 4px;
        cursor: default;
    }
    .moment-like span {
        color: var(--ifm-color-danger);
        font-size: 1rem;
        margin-right: 0.2rem;
    }
    /* æš—è‰²æ¨¡å¼è°ƒæ•´ */
    [data-theme='dark'] .moment-content {
        background-color: var(--ifm-background-surface-color);
        border-color: var(--ifm-color-emphasis-300);
    }
    [data-theme='dark'] .moment-avatar {
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    /* æ—¶é—´è½´å°åœ†ç‚¹è¦†ç›– */
    .moment-item::after {
        content: '';
        position: absolute;
        left: 27px;
        top: 18px;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--ifm-color-primary);
        border: 2px solid var(--ifm-background-color);
        z-index: 1;
        box-shadow: 0 0 0 1px var(--ifm-color-emphasis-300);
    }
    /* å¤´éƒ¨å¯æ·»åŠ äº’åŠ¨ */
    .moment-time {
        cursor: default;
    }
`}</style>

{/* Reactç»„ä»¶ï¼šå±•ç¤ºæœ‹å‹åœˆåˆ—è¡¨ */}
function MomentList() {
    // æ¨¡æ‹Ÿæ•°æ®ï¼šåœ¨å®é™…ä½¿ç”¨ä¸­å¯ä»¥ä»propsæˆ–é™æ€æ•°æ®å¯¼å…¥
    const moments = [
        {
            id: 1,
            author: "æˆ‘",
            avatar: "ğŸ˜", // å¯ä»¥ç”¨emojiæˆ–å›¾ç‰‡
            time: "5åˆ†é’Ÿå‰",
            content: "ä»Šå¤©å¤©æ°”çœŸå¥½ï¼Œé€‚åˆå†™ä»£ç ã€‚â˜€ï¸ è¿™ä¸ªç¢ç¢å¿µé¡µé¢æ„Ÿè§‰å°±åƒæœ‹å‹åœˆä¸€æ ·ï¼Œä»¥åè¦å¤šè®°å½•ä¸€äº›æ—¥å¸¸ã€‚",
            images: [
                "https://picsum.photos/400/300?random=1",
                "https://picsum.photos/400/300?random=2",
                "https://picsum.photos/400/300?random=3",
                "https://picsum.photos/400/300?random=4"
            ],
            likes: 5
        },
        {
            id: 2,
            author: "æˆ‘",
            avatar: "ğŸ˜",
            time: "æ˜¨å¤© 22:15",
            content: "æ·±å¤œæ€è€ƒï¼šä¸ºä»€ä¹ˆ Docusaurus è¿™ä¹ˆå¼ºå¤§ï¼Ÿå› ä¸º MDX è®©æˆ‘ä»¬å¯ä»¥éšæ„å®šåˆ¶ç»„ä»¶ã€‚æ¨èå¤§å®¶è¯•è¯•ï¼",
            images: [], // æ— å›¾
            likes: 12
        },
        {
            id: 3,
            author: "æˆ‘",
            avatar: "ğŸ˜",
            time: "2024-02-14",
            content: "åˆ†äº«ä¸€å¼ å›¾ã€‚æƒ…äººèŠ‚å¿«ä¹ï¼",
            images: [
                "https://picsum.photos/600/400?random=5"
            ],
            likes: 24
        },
        {
            id: 4,
            author: "æˆ‘",
            avatar: "ğŸ˜",
            time: "2024-02-10",
            content: "æ˜¥èŠ‚å‡æœŸï¼Œåœ¨è€å®¶æ”¾çƒŸèŠ±ğŸ† å¹´å‘³åè¶³ã€‚",
            images: [
                "https://picsum.photos/400/600?random=6",
                "https://picsum.photos/400/600?random=7"
            ],
            likes: 8
        },
        {
            id: 5,
            author: "æˆ‘",
            avatar: "ğŸ˜",
            time: "2024-01-30",
            content: "Docusaurus åšå®¢æ–°ä¸»é¢˜ï¼ŒMDX çœŸé¦™ã€‚",
            images: [],
            likes: 3
        }
    ];

    // å¤„ç†å›¾ç‰‡ç‚¹å‡»æ”¾å¤§ (ç®€å•alertæ¼”ç¤ºï¼Œå®é™…å¯ç”¨lightbox)
    const handleImageClick = (src) => {
        window.open(src, '_blank');
        // æˆ–è€…ç”¨alert: alert('æŸ¥çœ‹å¤§å›¾: ' + src);
    };

    return (
        <div className="moment-feed">
            {moments.map((item) => (
                <div key={item.id} className="moment-item">
                    {/* å¤´åƒåŒºåŸŸ */}
                    <div className="moment-avatar">
                        {item.avatar.match(/[\u{1f300}-\u{1f6ff}]/u) ? item.avatar : (
                            <img src={item.avatar} alt="avatar" />
                        )}
                    </div>
                    
                    {/* å†…å®¹å¡ç‰‡ */}
                    <div className="moment-content">
                        <div className="moment-header">
                            <span className="moment-author">{item.author}</span>
                            <span className="moment-time">{item.time}</span>
                        </div>
                        
                        {/* æ­£æ–‡ */}
                        <div className="moment-text">{item.content}</div>
                        
                        {/* å›¾ç‰‡ç½‘æ ¼ */}
                        {item.images && item.images.length > 0 && (
                            <div 
                                className={`moment-images ${item.images.length === 1 ? 'single' : ''}`}
                                style={item.images.length === 2 ? { gridTemplateColumns: 'repeat(2, 1fr)' } : {}}
                            >
                                {item.images.map((img, idx) => (
                                    <div
                                        key={idx}
                                        className="moment-image-item"
                                        style={{ backgroundImage: `url(${img})` }}
                                        onClick={() => handleImageClick(img)}
                                        role="button"
                                        tabIndex={0}
                                        aria-label="æŸ¥çœ‹å¤§å›¾"
                                        onKeyDown={(e) => (e.key === 'Enter' || e.key === ' ') && handleImageClick(img)}
                                    />
                                ))}
                            </div>
                        )}
                        
                        {/* ç‚¹èµåŒº */}
                        {item.likes > 0 && (
                            <div className="moment-actions">
                                <div className="moment-like">
                                    <span>â¤ï¸</span> {item.likes}
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            ))}
            
            {/* åº•éƒ¨æç¤º */}
            <div style={{ textAlign: 'center', marginTop: '3rem', color: 'var(--ifm-color-emphasis-500)', fontSize: '0.8rem' }}>
                â€”â€” æ²¡æœ‰æ›´å¤šäº†ï¼Œä½†ç”Ÿæ´»è¿˜åœ¨ç»§ç»­ â€”â€”
            </div>
        </div>
    );
}

{/* é»˜è®¤å¯¼å‡ºç”¨äºå¸ƒå±€ */}
export default function ThoughtsPage() {
    const { siteConfig } = useDocusaurusContext();
    return (
        <Layout
            title="ç¢ç¢å¿µ"
            description="æˆ‘çš„æœ‹å‹åœˆå¼ç¢ç¢å¿µé¡µé¢ï¼Œè®°å½•æ—¥å¸¸ä¸æ€è€ƒ">
            <main style={{ minHeight: '80vh' }}>
                {/* é€šè¿‡MDXç›´æ¥æ¸²æŸ“ */}
            </main>
        </Layout>
    );
}
